<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="research">
	<insert id="insertSurvey" parameterType="hashmap">
     <![CDATA[
         INSERT INTO SURVEY_LIST ( SURVEY_IDX
                            , REG_DATE
                            , DEADLINE_DATE
                            , SURVEY_POINT
                            , MAXIMUM_PART
                            , CURRENT_PART
                            , ISREPLY
                            , ISOPEN
                            , SURVEY_SUBJECT
                            , MEMBER_ID) VALUES ( SURVEY_SEQ.nextval
                                                 , SYSDATE
                                                 , #{deadline_date}
                                                 , #{survey_point}
                                                 , #{maximum_part}
                                                 , 0
                                                 , 0
                                                 , 0
                                                 , #{survey_subject}
                                                 , '123123')
     ]]>
     <selectKey keyProperty="survey_seq" resultType="int">
     	SELECT SURVEY_SEQ.CURRVAL FROM DUAL
     </selectKey>
    </insert>
    <insert id="insertCon" parameterType="hashmap">
   	INSERT INTO CONDITION_LIST (SURVEY_IDX
                         , CONDITION_IDX
                         , CONDITION_ORDER
                         , CONDITION_SUBJECT
                         , CON_OPT0
                         , CON_OPT1
                         , CON_OPT2
                         , CON_OPT3
                         , CON_OPT4
                         ) values ( #{survey_idx}
                                  , CONDITION_SEQ.nextval
                                  , #{condition_order}
                                  , #{condition_subject}
                                  <foreach collection="con_opt" item="item">
                                  , #{item}
                                  </foreach>
                                  <if test="con_opt.size == 2">
                                  ,null ,null ,null
                                  </if>
                                  <if test="con_opt.size == 3">
                                  ,null ,null
                                  </if>
                                  <if test="con_opt.size == 4">
                                  ,null
                                  </if>
                                  )	
    
	</insert>
	
    <insert id="insertQue" parameterType="hashmap">
   	INSERT INTO QUESTION_LIST (SURVEY_IDX
                         	, QUESTION_IDX
                         	, QUESTION_ORDER
                        	, QUESTION_SUBJECT
                         	, QUE_OPT0
                         	, QUE_OPT1
                         	, QUE_OPT2
                         	, QUE_OPT3
                         	, QUE_OPT4
                         	) values ( #{survey_idx}
                                  	 , QUESTION_SEQ.nextval
                                  	 , #{question_order}
                                  	 , #{question_subject}
                                  	 <foreach collection="que_opt" item="item">
                                  	 , #{item}
                                  	 </foreach>
                                  	 <if test="que_opt.size == 2">
                                  	 ,null ,null ,null
                                  	 </if>
                                  	 <if test="que_opt.size == 3">
                                  	 ,null ,null
                                  	 </if>
                                  	 <if test="que_opt.size == 4">
                                  	 ,null
                                  	 </if>
                                   	 )	
    
	</insert>
</mapper>


<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="inquiry">

<select id="show" parameterType="hashmap" resultType="hashmap">
	<![CDATA[
		 SELECT
			IDX,
			TITLE,
			HIT_CNT,
			REGIST_DATE
		FROM
			INQUIRY
		WHERE
			DEL_GB = 'N'
		ORDER BY RE_REF desc, re_step asc
	]]>
	</select>
	
	
<select id="showDetail" parameterType="hashmap" resultType="hashmap">
	<![CDATA[
		 SELECT
			IDX,
			TITLE,
			CONTENTS,
			HIT_CNT,
			REGIST_DATE
		FROM
			INQUIRY
		WHERE
			IDX = #{IDX}
	]]>
	</select>

<insert id="create" parameterType="hashmap">
	<![CDATA[
		INSERT INTO INQUIRY
		(
			INQUIRY_STATE,
            PARENT_IDX,
            IDX,
            RE_STEP,
            RE_REF,
            REGIST_DATE,
            HIT_CNT,
            DEL_GB,
            TITLE,
            CONTENTS
            )
		VALUES
		(
			0,
            0,
            SEQ_INQUIRY_IDX.NEXTVAL,
           0,
           SEQ_INQUIRY_IDX.NEXTVAL,
            SYSDATE,
            0,
            'N',
			#{TITLE},
			#{CONTENTS}
        )
			
	]]>

</insert>

<update id="updateHitCnt" parameterType="hashmap">
	<![CDATA[
		UPDATE INQUIRY
		SET
				HIT_CNT = NVL(HIT_CNT, 0) + 1
			WHERE
				IDX = #{IDX}	
		]]>

</update>


<update id="comments" parameterType="hashmap">
		<![CDATA[
			INSERT INTO INQUIRY
		(
			INQUIRY_STATE,
            PARENT_IDX,
            IDX,
            RE_STEP,
            RE_REF,
            REGIST_DATE,
            HIT_CNT,
            DEL_GB,
            TITLE,
            CONTENTS
            )
		VALUES
		(
			0,
            0,
           #{IDX},
           SEQ_INQUIRY_IDX.NEXTVAL + 1,
           1,
            SYSDATE,
            0,
            'N',
			#{TITLE},
			#{CONTENTS}
        )
		]]>
	</update>

<update id="update" parameterType="hashmap">
		<![CDATA[
			UPDATE INQUIRY
			SET
				TITLE = #{TITLE},
				CONTENTS = #{CONTENTS}
			WHERE
				IDX = #{IDX}	
		]]>
	</update>


<update id="delete" parameterType="hashmap">
	<![CDATA[
		UPDATE INQUIRY
		SET
			DEL_GB = 'Y'
		WHERE
			IDX = #{IDX}
	]]>
</update>


</mapper>
